% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/BayesFactor.R
\name{BayesFactor}
\alias{BayesFactor}
\title{Calculate Bayes Factor for Model Comparison}
\usage{
BayesFactor(
  Y,
  Xri,
  Xi,
  XIi,
  Tri,
  Ti,
  TIi,
  invAri,
  n,
  tau,
  nu,
  omega,
  flag,
  keep
)
}
\arguments{
\item{Y}{Numeric vector or matrix, the response variables.}

\item{Xri}{Numeric matrix, the design matrix without the variable of interest.}

\item{Xi}{Numeric vector or matrix, the design matrix for the variable of interest.}

\item{XIi}{Numeric matrix, the combined design matrix with the variable of interest.}

\item{Tri}{Numeric matrix, transformation matrix associated with Xri.}

\item{Ti}{Numeric vector or matrix, transformation matrix associated with Xi.}

\item{TIi}{Numeric matrix, combined transformation matrix.}

\item{invAri}{Numeric matrix, the inverse of the covariance matrix of the regression coefficients without the variable of interest.}

\item{n}{Integer, sample size or number of observations.}

\item{tau}{Numeric, hyperparameter scaling the precision matrix.}

\item{nu}{Numeric, degrees of freedom for the prior distribution of the error variance.}

\item{omega}{Numeric, scale parameter for the prior distribution of the error variance.}

\item{flag}{Boolean, indicates whether to include or exclude the variable of interest in the model.}

\item{keep}{List, contains previously calculated values required for updates (residual sum of squares and determinants).}
}
\value{
A list containing:
\itemize{
\item \code{F1} or \code{F}: The calculated Bayes Factor, depending on the flag.
\item \code{keep}: Updated list of auxiliary information.
\item \code{invAi}: Optionally, the updated inverse covariance matrix (only if \code{flag} is FALSE).
}
}
\description{
This function computes the Bayes Factor for comparing models in the context of Gibbs sampling
for Bayesian variable selection. It supports handling updates to the model based on the inclusion
or exclusion of a variable (flagged by the \code{flag} parameter). The function also updates
and returns the auxiliary information used in the Gibbs sampler.
}
\details{
The function performs a rank-1 update to the Cholesky decomposition when \code{flag} is FALSE,
indicating a variable exclusion scenario. When \code{flag} is TRUE, it simply recalculates based on
existing values. This functionality is crucial for dynamic model updating in Bayesian variable
selection techniques.
}
